{% extends 'Homepage.html' %}
{% load static %}

{% block title %}AudioX - Acquire Coins{% endblock %}

{% block content %}
<div class="bg-gradient-to-br from-gray-50 to-gray-200 min-h-screen py-16">
    <div class="container mx-auto px-4">
        <h1 class="text-4xl md:text-5xl font-extrabold text-center text-gray-800 mb-6 md:mb-10">
            Enhance Your AudioX Experience
        </h1>
        <p class="text-center text-gray-600 text-lg md:text-xl mb-12 md:mb-16 max-w-3xl mx-auto">
            Purchase coins to unlock premium features, exclusive content, and more.
        </p>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">

            {% comment %} Coin Pack Cards (No Images, Icon-Based, 3 Cards) {% endcomment %}
            <div class="bg-white rounded-3xl shadow-lg p-8 text-center transform transition duration-500 hover:scale-105 hover:shadow-xl relative overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-red-400 to-red-600 opacity-10 rounded-3xl"></div>
                <div class="relative z-10">
                    <i class="fas fa-coins text-5xl text-red-500 mb-4"></i>
                    <h2 class="text-2xl font-semibold text-gray-800 mb-2">100 Coins</h2>
                    <p class="text-red-500 mb-4">Bronze Pack</p>
                    <p class="text-3xl font-bold text-gray-800 mb-6">PKR 99</p>
                    <button data-pack-coins="100" data-pack-price="99" class="buy-coins-btn w-full bg-gradient-to-r from-red-500 to-red-700 hover:from-red-700 hover:to-red-900 text-white font-bold py-3 px-8 rounded-full transition duration-300 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-50">
                        Buy Now
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-3xl shadow-lg p-8 text-center transform transition duration-500 hover:scale-105 hover:shadow-xl relative overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-yellow-400 to-yellow-600 opacity-10 rounded-3xl"></div>
                <div class="relative z-10">
                    <i class="fas fa-coins text-5xl text-yellow-500 mb-4"></i>
                     <h2 class="text-2xl font-semibold text-gray-800 mb-2">250 Coins</h2>
                     <p class="text-yellow-500 mb-4">Emerald Pack</p>
                     <p class="text-3xl font-bold text-gray-800 mb-6">PKR 225</p>
                    <button data-pack-coins="250" data-pack-price="225" class="buy-coins-btn w-full bg-gradient-to-r from-yellow-500 to-yellow-700 hover:from-yellow-700 hover:to-yellow-900 text-white font-bold py-3 px-8 rounded-full transition duration-300 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-50">
                        Buy Now
                    </button>
                </div>
            </div>


            <div class="bg-white rounded-3xl shadow-lg p-8 text-center transform transition duration-500 hover:scale-105 hover:shadow-xl relative overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-[#091e65] to-[#06134d] opacity-10 rounded-3xl"></div>
                <div class="absolute top-4 right-4 bg-gradient-to-r from-[#091e65] to-[#06134d] text-white text-sm font-bold px-6 py-2 rounded-full">
                    Best Value
                </div>
                <div class="relative z-10">
                   <i class="fas fa-coins text-5xl text-[#091e65] mb-4"></i>
                    <h2 class="text-2xl font-semibold text-gray-800 mb-2">500 Coins</h2>
                    <p class="text-[#091e65] mb-4">Gold Pack</p>
                    <p class="text-3xl font-bold text-gray-800 mb-6">PKR 400</p>
                    <button data-pack-coins="500" data-pack-price="400" class="buy-coins-btn w-full bg-gradient-to-r from-[#091e65] to-[#06134d] hover:from-[#06134d] hover:to-[#091e65] text-white font-bold py-3 px-8 rounded-full transition duration-300 focus:outline-none focus:ring-2 focus:ring-[#091e65] focus:ring-opacity-50">
                        Buy Now
                    </button>
                </div>
            </div>
        </div>

        <div class="mt-16 bg-white rounded-3xl shadow-lg p-8">
             <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Why Buy AudioX Coins?</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-3"><i class="fas fa-gift text-blue-500 mr-2"></i> Gift Coins to Friends</h3>
                        <p class="text-gray-600">Share the joy of AudioX by gifting coins to your friends.  They can use the coins to unlock premium features or content.</p>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-3"><i class="fas fa-star text-yellow-500 mr-2"></i> Unlock Premium Features</h3>
                        <p class="text-gray-600">Access exclusive features like ad-free listening, higher audio quality, and offline downloads.</p>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-3"><i class="fas fa-microphone text-purple-500 mr-2"></i> Support Your Favorite Creators</h3>
                        <p class="text-gray-600">Use coins to directly support the creators you love.  Show your appreciation for their hard work and help them create more amazing content.</p>
                    </div>
                    <div>
                         <h3 class="text-xl font-semibold text-gray-700 mb-3"><i class="fas fa-lock text-green-500 mr-2"></i> Access Exclusive Content</h3>
                        <p class="text-gray-600">Unlock exclusive content like bonus episodes, behind-the-scenes material, and early access to new releases.</p>
                    </div>
                </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascript %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const buyButtons = document.querySelectorAll('.buy-coins-btn');

        buyButtons.forEach(button => {
            button.addEventListener('click', function() {
                const coins = this.dataset.packCoins;
                const price = this.dataset.packPrice;

                if (confirm(`Are you sure you want to buy ${coins} coins for PKR ${price}?`)) {
                    fetch("{% url 'buy_coins' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': '{{ csrf_token }}'
                        },
                        body: JSON.stringify({ coins: coins, price: price })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'success') {
                            alert(data.message);
                            const coinBalanceElement = document.querySelector('header .coin-wallet-btn span');  //Corrected Selector
                            if (coinBalanceElement) {
                                coinBalanceElement.textContent = `${data.new_coin_balance} Coins`;
                            }
                            location.reload(); // Reload to update purchase history (removed now)
                        } else {
                            alert(`Error: ${data.message}`);
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('An error occurred while processing your request.');
                    });
                }
            });
        });
    });

</script>
{% endblock %}